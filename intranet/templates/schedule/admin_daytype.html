{% extends "page_with_nav.html" %}
{% load staticfiles %}

{% block title %}
    {{ block.super}} - Schedule - {{ date }}
{% endblock %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static "css/schedule.css" %}" />
    <style type="text/css">
    .primary-content {
        position: relative;
    }

    .bellschedule-table {
        position: absolute;
        width: 300px;
        left: 50%;
        margin-left: -150px;
        font-size: 18px;
    }

    .bellschedule-table thead th.special {
        font-size: 12px;
        text-align: right;
    }

    .bellschedule-table #id_name {
        font-size: 20px;
        width: 100%;
        text-align: center;
    }

    .bellschedule-table td {
        padding: 4px 0;
    }

    .bellschedule-table td.time {
        font-size: 12px;
        text-align: right;
    }

    .bellschedule-table td.submit > input {
        width: 100%;
    }

    </style>
{% endblock %}

{% block js %}
    {{ block.super }}
    <script type="text/javascript">
    $(document).ready(function() {
        var bt = $(".bellschedule-table tr.tpl").clone();
        bt.removeClass("tpl");
        add_block = function() {
            var clone = bt.clone();

            $(".bellschedule-table > tbody").append(clone);
        }

    })
    </script>
{% endblock %}

{% block main %}
    <div class="primary-content">
        <h2>{% if daytype %}Edit{% else %}Create{% endif %} Day Type</h2>
        {% comment %}<table>
        {{ form.as_table }}
        </table>
        {% endcomment %}
        <form action="/schedule/daytype" method="post">
        {% csrf_token %}
        {% if daytype %}
            <input type="hidden" name="id" value="{{ daytype.id }}" />
        {% endif %}
        <br /><br />
            <table class="bellschedule-table">
            <thead>
                <tr>
                    <th colspan="2">
                        <input id="id_name" name="name" placeholder="Day Name" value="{% if daytype %}{{ daytype.name }}{% endif %}" />
                    </th>
                </tr>
                <tr>
                    <th colspan="2" class="special">
                        <label for="special">Special</label>
                        <input type="checkbox" name="special"{% if daytype and daytype.special %} checked="checked"{% endif %} />
                    </th>
                </tr>
                <tr>&nbsp;</tr>
            </thead>
            <tbody>
            {% if daytype %}
            {% for block in daytype.blocks.all %}
                <tr{% if forloop.first %} class="tpl"{% endif %}>
                    <th><input type="hidden" name="order" value={{ forloop.counter }} />
                        <input type="text" name="block_name" value="{{ block.name }}" placeholder="Block Title" />
                    </th>
                    <td class="time">
                        Start: <input type="time" name="block_start" value="{% if block.start.hour < 10 %}0{% endif %}{{ block.start }}" size="5" /><br />
                        End: <input type="time" name="block_end" value="{% if block.end.hour < 10 %}0{% endif %}{{ block.end }}" size="5" />
                    </td>
                    <td class="remove">
                        <button onclick="$(this).parent().parent().remove()">
                            <i class="fa fa-times"></i>
                        </button>
                    </td>
                </tr>
            {% empty %}
                <tr class="tpl">
                    
                    <th><input type="hidden" name="order" value=1 />
                        <input type="text" name="block_name" value="" placeholder="Block Title" />
                    </th>
                    <td class="time">
                        Start: <input type="time" name="block_start" value="" size="5" /><br />
                        End: <input type="time"name="block_end" value="" size="5" />
                    </td>
                    <td class="remove">
                        <button onclick="$(this).parent().parent().remove()">
                            <i class="fa fa-times"></i>
                        </button>
                    </td>
                </tr>
            {% endfor %}
            {% else %}
                <tr class="tpl">
                    <th><input type="hidden" name="order" value=1 />
                        <input type="text" name="block_name" value="" placeholder="Block Title" />
                    </th>
                    <td class="time">
                        Start: <input type="time" name="block_start" value="" size="5" /><br />
                        End: <input type="time"name="block_end" value="" size="5" />
                    </td>
                    <td class="remove">
                        <button onclick="$(this).parent().parent().remove()">
                            <i class="fa fa-times"></i>
                        </button>
                    </td>
                </tr>
            {% endif %}
            </tbody>
            <tfoot>
                <tr>
                    <td class="submit">
                        <input type="submit" value="{% if daytype %}Modify{% else %}Create{% endif %}" class="button" />
                    </td>
                    <td class="add">
                        <a class="button" onclick="add_block()">
                            <i class="fa fa-plus"></i> Add Block
                        </a>
                    </td>
                </tr>
            </tfoot>
            </table>
        </form>
    </div>
{% endblock %}